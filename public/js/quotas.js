webpackJsonp([3],{0:function(t,e,s){s("dPgO"),t.exports=s("aMfE")},"5Ped":function(t,e,s){var a=s("VU/8")(s("ZtKd"),s("u70O"),!1,null,null,null);t.exports=a.exports},KfGq:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("select",{directives:[{name:"model",rawName:"v-model",value:t.selected,expression:"selected"}],on:{change:[function(e){var s=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.selected=e.target.multiple?s:s[0]},t.teamChange]}},t._l(t.teams,function(e){var a=e.id,o=e.title,n=e.disabled;return s("option",{key:a,attrs:{disabled:n},domProps:{value:a}},[t._v(t._s(o))])}))},staticRenderFns:[]}},"VU/8":function(t,e){t.exports=function(t,e,s,a,o,n){var r,l=t=t||{},i=typeof t.default;"object"!==i&&"function"!==i||(r=t,l=t.default);var c,u="function"==typeof l?l.options:l;if(e&&(u.render=e.render,u.staticRenderFns=e.staticRenderFns,u._compiled=!0),s&&(u.functional=!0),o&&(u._scopeId=o),n?(c=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),a&&a.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(n)},u._ssrRegister=c):a&&(c=a),c){var d=u.functional,m=d?u.render:u.beforeCreate;d?(u._injectStyles=c,u.render=function(t,e){return c.call(e),m(t,e)}):u.beforeCreate=m?[].concat(m,c):[c]}return{esModule:r,exports:l,options:u}}},WRGp:function(t,e,s){void 0===window.axios&&(window.axios=s("mtWM"));var a=document.head.querySelector('meta[name="csrf-token"]');window.axios.defaults.headers.common["X-Requested-With"]="XMLHttpRequest",a?window.axios.defaults.headers.common["X-CSRF-TOKEN"]=a.content:console.error("CSRF token not found: https://laravel.com/docs/csrf#csrf-x-csrf-token")},ZtKd:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"quotaList",data:function(){return{result:{},msg:"",status:!0}},methods:{closeAlert:function(){this.msg=!1,this.status=!0},publish:function(t){var e=this;if(confirm("确定要发布这篇文章吗？")){var s=e.result.data[t];e.$set(e.result.data[t],"onqueue",!0),e.result.data[t]=s,axios.post("/api/v1/quotas/publish/"+s.id).then(function(s){e.result.data.splice(t,1),e.status=0===s.data.code,e.msg=e.status?s.data.data:s.data.message}).catch(function(t){console&&"function"==typeof console.log&&console.log(t),e.msg="请求失败，请联系管理员解决。",e.status=!1})}},del:function(t){var e=this;if(confirm("确定要删除这篇文章吗？")){var s=e.result.data[t];axios.post("/api/v1/quotas/del/"+s.id).then(function(t){e.status=0===t.data.code,e.msg=e.status?t.data.data:t.data.message,e.fetch()}).catch(function(t){console&&"function"==typeof console.log&&console.log(t),e.msg="请求失败，请联系管理员解决。",e.status=!1})}},fetch:function(t){t=void 0===t||isNaN(t)?1:t;var e=this;axios.post("/api/v1/quotas/list",{size:20,page:t}).then(function(t){e.result=t.data.data}).catch(function(t){try{console.log(t.data)}catch(t){}})}},created:function(){this.fetch()}}},aMfE:function(t,e){},dPgO:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("I3G/"),o=s.n(a);s("WRGp");var n=s("5Ped"),r=s("ifTf");window.bus=new o.a;new o.a({el:"#quotaApp",components:{quotaList:n,siteList:r}})},ifTf:function(t,e,s){var a=s("VU/8")(s("wIas"),s("wBqn"),!1,null,null,null);t.exports=a.exports},jlZM:function(t,e,s){var a=s("VU/8")(s("r8Bt"),s("KfGq"),!1,null,null,null);t.exports=a.exports},r8Bt:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"teamSelector",props:{site:{team_id:null}},data:function(){return{selected:null,teams:[{id:null,title:"请选择所属团队",disabled:!0},{id:null,title:"======================",disabled:!0}]}},watch:{site:function(t){this.selected=t.team_id}},methods:{teamChange:function(){bus.$emit("teamChange",this.selected)}},created:function(){var t=this;axios.get("/api/v1/teams/list").then(function(e){var s=e.data;t.$set(t,"teams",t.teams.concat(s.data))})}}},u70O:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{directives:[{name:"show",rawName:"v-show",value:t.msg,expression:"msg"}],staticClass:"alert alert-dismissible",class:{"alert-success":t.status,"alert-danger":!t.status},attrs:{role:"alert"}},[s("button",{staticClass:"close",attrs:{type:"button"},on:{click:function(e){e.preventDefault(),t.closeAlert()}}},[s("span",{attrs:{"aria-hidden":"true"}},[t._v("×")]),t._v(" "),s("span",{staticClass:"sr-only"},[t._v("Close")])]),t._v(" "),s("strong",[t._v(t._s(t.msg))])]),t._v(" "),s("table",{staticClass:"table table-bordered"},[t._m(0),t._v(" "),s("tbody",t._l(t.result.data,function(e,a){return s("tr",[s("td",[t._v(t._s(e.id))]),t._v(" "),s("td",[s("a",{attrs:{href:e.url,title:e.title}},[t._v(t._s(e.title))])]),t._v(" "),s("td",[s("a",{attrs:{href:e.site_url,title:e.site_name}},[t._v(t._s(e.site_name))])]),t._v(" "),s("td",[t._v(t._s(e.team?e.team.title:"未设定"))]),t._v(" "),s("td",[s("a",{attrs:{href:e.author_url,title:e.author_name}},[t._v(t._s(e.author_name))])]),t._v(" "),s("td",[t._v(t._s(e.tags))]),t._v(" "),s("td",[s("button",{staticClass:"btn btn-xs btn-warning",attrs:{disabled:e.onqueue},on:{click:function(e){t.publish(a)}}},[t._v("发布")]),t._v(" "),s("button",{staticClass:"btn btn-xs btn-danger",on:{click:function(e){t.del(a)}}},[t._v("删除")])])])}))]),t._v(" "),s("ul",{directives:[{name:"show",rawName:"v-show",value:t.result.total>1,expression:"result.total > 1"}],staticClass:"pagination"},[t.result.prev_page_url?s("li",[s("a",{attrs:{href:"#",rel:"prev"},on:{click:function(e){e.preventDefault(),t.fetch(t.result.current_page-1)}}},[t._v("上一页")])]):s("li",{staticClass:"disabled"},[s("span",[t._v("上一页")])]),t._v(" "),s("li",{staticClass:"disabled"},[s("span",[t._v(t._s(t.result.current_page)+" / "+t._s(parseInt(t.result.total/t.result.per_page)+1))])]),t._v(" "),t.result.next_page_url?s("li",[s("a",{attrs:{href:"#",rel:"next"},on:{click:function(e){e.preventDefault(),t.fetch(t.result.current_page+1)}}},[t._v("下一页")])]):s("li",{staticClass:"disabled"},[s("span",[t._v("下一页")])])])])},staticRenderFns:[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("thead",{staticClass:"bg-primary"},[s("tr",[s("th",[t._v("ID")]),t._v(" "),s("th",[t._v("标题")]),t._v(" "),s("th",[t._v("站点")]),t._v(" "),s("th",[t._v("团队")]),t._v(" "),s("th",[t._v("作者")]),t._v(" "),s("th",[t._v("标签")]),t._v(" "),s("th",[t._v("操作")])])])}]}},wBqn:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"row"},[s("div",{staticClass:"col-sm-9"},[s("table",{staticClass:"table table-bordered"},[t._m(0),t._v(" "),s("tbody",t._l(t.rows,function(e,a){return s("tr",[s("td",[t._v(t._s(e.id))]),t._v(" "),s("td",[s("a",{attrs:{href:e.url,title:e.name}},[t._v(t._s(e.name))])]),t._v(" "),s("td",[t._v(t._s(e.team?e.team.title:"未设定"))]),t._v(" "),s("td",[t._v(t._s(e.published?"是":"否"))]),t._v(" "),s("td",[t._v(t._s(e.last_check))]),t._v(" "),s("td",[t._v(t._s(e.list_url))]),t._v(" "),s("td",[s("button",{staticClass:"btn btn-xs btn-success",on:{click:function(e){t.edit(a)}}},[t._v("编辑")]),t._v(" "),s("button",{staticClass:"btn btn-xs btn-danger",on:{click:function(s){t.del(e.id)}}},[t._v("删除")]),t._v(" "),s("button",{staticClass:"btn btn-xs btn-primary",on:{click:function(s){t.fetch(e.id)}}},[t._v("抓取")])])])}))])]),t._v(" "),s("div",{staticClass:"col-sm-3"},[s("div",{staticClass:"form"},[s("div",{staticClass:"form-group"},[s("label",{staticClass:"form-label",attrs:{for:"name"}},[t._v("名称")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.name,expression:"form.name"}],staticClass:"form-control",attrs:{name:"name",id:"name",type:"text"},domProps:{value:t.form.name},on:{input:function(e){e.target.composing||t.$set(t.form,"name",e.target.value)}}})]),t._v(" "),s("div",{staticClass:"form-group"},[s("label",{staticClass:"form-label",attrs:{for:"url"}},[t._v("地址")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.url,expression:"form.url"}],staticClass:"form-control",attrs:{name:"url",id:"url",type:"text"},domProps:{value:t.form.url},on:{input:function(e){e.target.composing||t.$set(t.form,"url",e.target.value)}}})]),t._v(" "),s("div",{staticClass:"form-group"},[s("label",{staticClass:"form-label",attrs:{for:"team"}},[t._v("所属团队")]),t._v(" "),s("team-selector",{staticClass:"form-control",attrs:{id:"team",name:"team",site:t.form}})],1),t._v(" "),s("div",{staticClass:"form-group"},[s("label",{staticClass:"form-label",attrs:{for:"list_url"}},[t._v("列表页地址")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.list_url,expression:"form.list_url"}],staticClass:"form-control",attrs:{name:"list_url",id:"list_url",type:"text"},domProps:{value:t.form.list_url},on:{input:function(e){e.target.composing||t.$set(t.form,"list_url",e.target.value)}}})]),t._v(" "),s("div",{staticClass:"form-group"},[s("label",{staticClass:"form-label",attrs:{for:"selLink"}},[t._v("链接选择器")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.sel_link,expression:"form.sel_link"}],staticClass:"form-control",attrs:{name:"selLink",id:"selLink",type:"text",placeholder:"选择器对应元素href属性为详情页url"},domProps:{value:t.form.sel_link},on:{input:function(e){e.target.composing||t.$set(t.form,"sel_link",e.target.value)}}})]),t._v(" "),s("div",{staticClass:"form-group"},[s("label",{staticClass:"form-label",attrs:{for:"selTitle"}},[t._v("标题选择器")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.sel_title,expression:"form.sel_title"}],staticClass:"form-control",attrs:{name:"selTitle",id:"selTitle",type:"text",placeholder:"选择器对应元素innerText为标题"},domProps:{value:t.form.sel_title},on:{input:function(e){e.target.composing||t.$set(t.form,"sel_title",e.target.value)}}})]),t._v(" "),s("div",{staticClass:"form-group"},[s("label",{staticClass:"form-label",attrs:{for:"selContent"}},[t._v("内容选择器")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.sel_content,expression:"form.sel_content"}],staticClass:"form-control",attrs:{name:"selContent",id:"selContent",type:"text",placeholder:"选择器对应元素的innerHTML为内容"},domProps:{value:t.form.sel_content},on:{input:function(e){e.target.composing||t.$set(t.form,"sel_content",e.target.value)}}})]),t._v(" "),s("div",{staticClass:"form-group"},[s("label",{staticClass:"form-label",attrs:{for:"selTag"}},[t._v("标签选择器")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.sel_tag,expression:"form.sel_tag"}],staticClass:"form-control",attrs:{name:"selTag",id:"selTag",type:"text",placeholder:"选择器对应元素的innerText为标签"},domProps:{value:t.form.sel_tag},on:{input:function(e){e.target.composing||t.$set(t.form,"sel_tag",e.target.value)}}})]),t._v(" "),s("div",{staticClass:"form-group"},[s("label",{staticClass:"form-label",attrs:{for:"selAuthorLink"}},[t._v("作者地址选择器")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.sel_author_link,expression:"form.sel_author_link"}],staticClass:"form-control",attrs:{name:"selAuthor",id:"selAuthorLink",type:"text",placeholder:"选择器对应元素的href为作者地址"},domProps:{value:t.form.sel_author_link},on:{input:function(e){e.target.composing||t.$set(t.form,"sel_author_link",e.target.value)}}})]),t._v(" "),s("div",{staticClass:"form-group"},[s("label",{staticClass:"form-label",attrs:{for:"selAuthorName"}},[t._v("作者名称选择器")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.sel_author_name,expression:"form.sel_author_name"}],staticClass:"form-control",attrs:{name:"selAuthor",id:"selAuthorName",type:"text",placeholder:"选择器对应元素的innerText为作者地址"},domProps:{value:t.form.sel_author_name},on:{input:function(e){e.target.composing||t.$set(t.form,"sel_author_name",e.target.value)}}})]),t._v(" "),s("div",{staticClass:"form-group"},[s("label",{staticClass:"form-label",attrs:{for:"published"}},[t._v("自动发布 "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.published,expression:"form.published"}],attrs:{type:"checkbox",name:"published",value:"true",id:"published"},domProps:{checked:Array.isArray(t.form.published)?t._i(t.form.published,"true")>-1:t.form.published},on:{change:function(e){var s=t.form.published,a=e.target,o=!!a.checked;if(Array.isArray(s)){var n=t._i(s,"true");a.checked?n<0&&t.$set(t.form,"published",s.concat(["true"])):n>-1&&t.$set(t.form,"published",s.slice(0,n).concat(s.slice(n+1)))}else t.$set(t.form,"published",o)}}})])])]),t._v(" "),s("button",{staticClass:"btn btn-success",on:{click:t.checkFetch}},[t._v("测试抓取")]),t._v(" "),s("button",{staticClass:"btn btn-primary",on:{click:t.submit}},[t._v("保存站点")])])])},staticRenderFns:[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("thead",{staticClass:"bg-primary"},[s("tr",[s("th",[t._v("ID")]),t._v(" "),s("th",[t._v("名称")]),t._v(" "),s("th",[t._v("所属团队")]),t._v(" "),s("th",[t._v("自动发布")]),t._v(" "),s("th",[t._v("最后采集时间")]),t._v(" "),s("th",[t._v("列表地址")]),t._v(" "),s("th",[t._v("操作")])])])}]}},wIas:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"siteList",components:{teamSelector:s("jlZM")},data:function(){return{rows:[],form:{name:"",url:"",team_id:null,team:{id:null,title:null},list_url:"",sel_link:"",sel_title:"",sel_content:"",sel_tag:"",sel_author_link:"",sel_author_name:"",published:!1}}},methods:{edit:function(t){this.form=Object.assign({},this.rows[t])},del:function(t){var e=this;axios.post("/api/v1/site/del/"+t).then(function(){e.loadSites.call(e)}).catch(function(t){try{console.log(t)}catch(t){}})},submit:function(){var t=this;axios.post("/api/v1/site",this.form).then(function(){t.loadSites()}).catch(function(t){if(t.response){var e=t.response.data,s=[];for(var a in e)s.push(""+e[a]);return alert(s.join("\n")),!0}alert(t)})},checkFetch:function(){axios.post("/api/v1/site/check",this.form).then(function(t){try{console.log(t.data.data)}catch(t){}}).catch(function(t){try{console.log("fail")}catch(t){}})},fetch:function(t){try{console.log("wait...")}catch(t){}var e=this;axios.post("/api/v1/site/fetch/"+t).then(function(t){e.loadSites()}).catch(function(t){try{console.log(t)}catch(t){}})},loadSites:function(){var t=this;axios.post("/api/v1/sites",{size:20}).then(function(e){var s=e.data;t.rows=s.data.data}).catch(function(t){try{console.log(t)}catch(t){}})}},created:function(){var t=this;this.loadSites(),bus.$on("teamChange",function(e){t.$set(t.form,"team_id",e)})}}}},[0]);